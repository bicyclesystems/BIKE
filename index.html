<!DOCTYPE html>
<html lang="en">

<head>
  <title>Bike</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="rene/index.css">

</head>

<body class="view align-center justify-center"
  style="background-size: cover; background-position: center center; background-repeat: no-repeat; background-attachment: fixed;">



  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Monaco Editor -->
  <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
      <script src="views/nohost/filer.min.js"></script>
  <script src="views/nohost/nohost-manager.js"></script>
  <script src="views/nohost/nohost-debug.js"></script>
  <script src="config.js"></script>
  <script src="memory.js"></script>
  <script src="sync.js"></script>
  <script src="actions/actions.js"></script>
      <!-- Modular artifact renderers -->
    <script src="views/view-artifact/view-artifact-image.js"></script>
    <script src="views/view-artifact/view-artifact-html.js"></script>
    <script src="views/view-artifact/view-artifact-md.js"></script>
    <script src="views/view-artifact/view-artifact-link.js"></script>
    <script src="views/view-artifact/view-artifact-files.js"></script>
    <script src="views/view-artifact/view-artifact-text.js"></script>
    <!-- Main artifact view coordinator -->
    <script src="views/view-artifact/view-artifact.js"></script>
    <script src="views/view-artifacts.js"></script>
  <script src="views/view-calendar.js"></script>
  <script src="views/view-memory.js"></script>
  <script src="views/view-services.js"></script>
  <script src="views/view-chat.js"></script>
  <script src="views/view-actions.js"></script>
  <script src="views/view-system.js"></script>
  <script src="views/views.js"></script>
  <script src="actions/actions-chat.js"></script>
  <script src="actions/actions-artifacts.js"></script>
  <script src="actions/actions-views.js"></script>
  <script src="actions/actions-user.js"></script>
  <script src="actions/actions-memory.js"></script>
  <script src="context/context.js"></script>
  <script src="context/context-highlight.js"></script>
  <script src="user.js"></script>
      <script src="artifacts/artifacts.js"></script>
  <script src="input.js"></script>
  <script src="system.js"></script>
  <script src="process/process.js"></script>
  <script src="process/process-image.js"></script>
  <script src="process/process-content.js"></script>
  <script src="orchestrate.js"></script>
      <script src="chat.js"></script>
  <script src="theme.js"></script>
  <script src="template/template.js"></script>
  <script>
    console.log('[SCRIPT] Main initialization script loaded');
    // Fast initialization - defer heavy operations
    document.addEventListener('DOMContentLoaded', async function () {
      console.log('[INIT] DOMContentLoaded event fired');
      // Initialize authentication FIRST to determine user state
      const session = await user.initAuth();
      
      // Initialize context quickly (defer heavy IndexedDB operations)
      await context.init(session);

      // Show UI immediately - don't wait for sync
      await user.updateAuthState(session);

      // Initialize modules (UI is now ready) - wait for artifacts to be fully available
      const waitForArtifacts = () => {
        if (window.artifacts && typeof window.artifacts.init === 'function') {
          console.log('[INIT] Artifacts module loaded, calling init()');
          artifacts.init();
        } else {
          console.log('[INIT] Waiting for artifacts module...');
          setTimeout(waitForArtifacts, 50);
        }
      };
      waitForArtifacts();
      views.init();
      
      // Initialize NoHost explicitly after everything is loaded
      setTimeout(() => {
        if (window.noHostManager) {
          console.log('[INIT] Testing NoHost initialization...');
          window.noHostManager.init().then(() => {
            console.log('[INIT] NoHost successfully initialized');
          }).catch(err => {
            console.error('[INIT] NoHost failed to initialize:', err);
          });
        }
      }, 1000);
      
      // Initialize sync in background after UI is ready
      if (session && window.syncManager) {
        window.syncManager.initializeWithAuth(window.supabase, session)
          .then(() => console.log('[INIT] Background sync complete'))
          .catch(err => console.warn('[INIT] Background sync failed:', err));
      }
    });
  </script>
</body>

</html>